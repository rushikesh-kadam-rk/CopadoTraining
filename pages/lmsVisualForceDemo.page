<apex:page lightningStylesheets="true">
    <apex:slds />
    <div class="slds-scope">
        <div class="slds-p-around_small">
            <label>Enter publish Message</label>
            <!--<input type="text" class="slds-input" id="messageField"/>
            <div class="slds-p-top_small slds-p-bottom_small">
                <button class="slds-button slds-button_neutral" onclick="publishHandler()">Publish</button>
                <button class="slds-button slds-button_neutral" onclick="subscriberHandler()">Subscribe</button>
                <button class="slds-button slds-button_neutral" onclick="unsubscriberHandler()">Unsubscribe</button>
            </div>-->
            <div class="slds-p-top_small slds-p-bottom_small">
                <button class="slds-button slds-button_neutral" onclick="handleDiv()">Hide/Show Div</button>
            </div>
            <p>message Recieved</p>
            <div id="btnNotClicked" style="display:block;">Button Not Clicked</div>
            <div id="btnClicked" style="display:none;">Button Clicked</div>
        </div>
    </div>
    <script>
    	function handleDiv(){
            let btnNotClicked = document.getElementById("btnNotClicked");
            btnNotClicked.style.display = 'none';
        	let btnClicked = document.getElementById("btnClicked");
            btnClicked.style.display = 'block';
            hideMessage();
        }
    	function hideMessage(){
        	setTimeout(function(){
           		let btnNotClicked = document.getElementById("btnNotClicked");
                btnNotClicked.style.display = 'block';
                let btnClicked = document.getElementById("btnClicked");
                btnClicked.style.display = 'none';
            }, 5000);
        }
    	
        let SAMPLEMC  ="{!$MessageChannel.SampleMessageChannel__c}"
        let subscriptionToMC
      	function publishHandler(){
            /*let data = document.getElementById("messageField").value
              const message={
                  lmsData:{
                      value:data,
                  }
              }
              sforce.one.publish(SAMPLEMC, message)*/
      	}

        function subscriberHandler(){
            if(!subscriptionToMC){
                subscriptionToMC = sforce.one.subscribe(SAMPLEMC, msgHandler, {scope:"APPLICATION"});
                console.log('subscriptionToMC:::', subscriptionToMC)
            }
        }
        
        function unsubscriberHandler(){
            if(subscriptionToMC){
                sforce.one.unsubscribe(subscriptionToMC)
                subscriptionToMC=null
            }
        }

        function msgHandler(message){
            console.log(message);
            let recievedMessage= document.getElementById("recievedMessage")
            recievedMessage.innerHTML = message && message.lmsData ? `${message.lmsData.value}+${message.lmsData.recordId}+${message.lmsData.recordData}`:"No Data Send"
        }
    	
    </script>
</apex:page>